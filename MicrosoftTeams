var configModule = require("./config");
var clientModule = require("./client");
var conMngr = require("./webhook/incomming/connectormanager");

function MicrosoftTeams(config) {
    
    if (config) {
        
        for(var key in config){
            this[key] = config[key]
        }
    }
   
    this.team = this.team ? this.team : configModule.team;
    
    this.client=this.client?this.client:new clientModule.Client({endPoint:this.team.baseUrl} );
    
}

MicrosoftTeams.prototype.getConnectorManager = function() {
  
    if (!this.connectorManager) {
        this.connectorManager = new conMngr.ConnectorManager({
            client:this.client
        });
    }
    
    return this.connectorManager;
};